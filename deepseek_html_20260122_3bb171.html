<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لوحة تحكم الإدارة - نيون ستور</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --galaxy-black: #0c0c1d;
            --galaxy-dark: #1a1a2e;
            --galaxy-blue: #16213e;
            --galaxy-purple: #4a1e5a;
            --galaxy-pink: #9d4edd;
            --galaxy-cyan: #00bbf9;
            --galaxy-green: #00f5d4;
            --text-light: #f8f9fa;
            --text-gray: #adb5bd;
            --danger: #ff6b6b;
            --warning: #ff9e00;
            --success: #00d4aa;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Tajawal', sans-serif;
        }
        
        body {
            background-color: var(--galaxy-black);
            color: var(--text-light);
            min-height: 100vh;
        }
        
        .admin-container {
            display: flex;
            min-height: 100vh;
        }
        
        /* الشريط الجانبي */
        .admin-sidebar {
            width: 250px;
            background: rgba(26, 26, 46, 0.95);
            border-left: 1px solid rgba(157, 78, 221, 0.3);
            padding: 20px 0;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
        }
        
        .admin-logo {
            text-align: center;
            padding: 20px;
            border-bottom: 1px solid rgba(157, 78, 221, 0.3);
            margin-bottom: 20px;
        }
        
        .admin-logo h2 {
            color: var(--galaxy-cyan);
            font-size: 1.5rem;
        }
        
        .admin-nav ul {
            list-style: none;
        }
        
        .admin-nav li {
            margin-bottom: 5px;
        }
        
        .admin-nav a {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 25px;
            color: var(--text-light);
            text-decoration: none;
            transition: all 0.3s;
            border-right: 3px solid transparent;
        }
        
        .admin-nav a:hover,
        .admin-nav a.active {
            background: rgba(157, 78, 221, 0.1);
            border-right-color: var(--galaxy-pink);
            color: var(--galaxy-cyan);
        }
        
        .admin-nav i {
            width: 20px;
            text-align: center;
        }
        
        /* المحتوى الرئيسي */
        .admin-content {
            flex: 1;
            margin-right: 250px;
            padding: 20px;
        }
        
        .admin-header {
            background: rgba(26, 26, 46, 0.8);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border: 1px solid rgba(157, 78, 221, 0.3);
            display: flex;
            justify-content: space-between;
            align-items: center;
            backdrop-filter: blur(10px);
        }
        
        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: rgba(26, 26, 46, 0.8);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid rgba(157, 78, 221, 0.3);
            transition: transform 0.3s;
            backdrop-filter: blur(10px);
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            border-color: var(--galaxy-cyan);
        }
        
        .stat-icon {
            font-size: 2rem;
            color: var(--galaxy-pink);
            margin-bottom: 10px;
        }
        
        .stat-value {
            font-size: 2rem;
            color: var(--galaxy-green);
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: var(--text-gray);
            font-size: 0.9rem;
        }
        
        /* الجداول */
        .admin-table {
            background: rgba(26, 26, 46, 0.8);
            border-radius: 10px;
            overflow: hidden;
            border: 1px solid rgba(157, 78, 221, 0.3);
            backdrop-filter: blur(10px);
            margin-bottom: 30px;
        }
        
        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid rgba(157, 78, 221, 0.3);
        }
        
        .table-header h3 {
            color: var(--galaxy-cyan);
            font-size: 1.3rem;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th {
            background: rgba(26, 26, 46, 0.9);
            padding: 15px;
            text-align: right;
            color: var(--galaxy-cyan);
            border-bottom: 1px solid rgba(157, 78, 221, 0.3);
        }
        
        td {
            padding: 15px;
            border-bottom: 1px solid rgba(157, 78, 221, 0.1);
        }
        
        tr:hover {
            background: rgba(157, 78, 221, 0.05);
        }
        
        .badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .badge-new { background: rgba(0, 187, 249, 0.2); color: var(--galaxy-cyan); }
        .badge-processing { background: rgba(255, 158, 0, 0.2); color: var(--warning); }
        .badge-delivered { background: rgba(0, 212, 170, 0.2); color: var(--galaxy-green); }
        .badge-cancelled { background: rgba(255, 107, 107, 0.2); color: var(--danger); }
        
        .action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.3s;
            margin: 0 3px;
        }
        
        .btn-view { background: var(--galaxy-cyan); color: white; }
        .btn-edit { background: var(--warning); color: white; }
        .btn-delete { background: var(--danger); color: white; }
        .btn-delivered { background: var(--galaxy-green); color: var(--galaxy-black); }
        
        .action-btn:hover {
            opacity: 0.8;
            transform: translateY(-2px);
        }
        
        .search-box {
            background: rgba(26, 26, 46, 0.7);
            border: 1px solid rgba(157, 78, 221, 0.3);
            border-radius: 8px;
            padding: 10px 15px;
            color: var(--text-light);
            width: 300px;
        }
        
        .search-box:focus {
            outline: none;
            border-color: var(--galaxy-cyan);
        }
        
        .empty-state {
            text-align: center;
            padding: 50px 20px;
            color: var(--text-gray);
        }
        
        .empty-state i {
            font-size: 3rem;
            margin-bottom: 20px;
            color: var(--galaxy-pink);
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(12, 12, 29, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: var(--galaxy-dark);
            border-radius: 15px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid rgba(157, 78, 221, 0.3);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(157, 78, 221, 0.3);
        }
        
        .modal-header h3 {
            color: var(--galaxy-cyan);
        }
        
        .close-modal {
            background: none;
            border: none;
            color: var(--text-light);
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        .close-modal:hover {
            color: var(--galaxy-pink);
        }
        
        @media (max-width: 768px) {
            .admin-container {
                flex-direction: column;
            }
            
            .admin-sidebar {
                width: 100%;
                position: static;
                height: auto;
            }
            
            .admin-content {
                margin-right: 0;
            }
            
            .search-box {
                width: 100%;
                margin-top: 10px;
            }
            
            .admin-stats {
                grid-template-columns: 1fr;
            }
            
            table {
                display: block;
                overflow-x: auto;
            }
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <!-- الشريط الجانبي -->
        <aside class="admin-sidebar">
            <div class="admin-logo">
                <h2><i class="fas fa-cogs"></i> لوحة التحكم</h2>
                <p style="color: var(--text-gray); font-size: 0.9rem;">نيون ستور</p>
            </div>
            
            <nav class="admin-nav">
                <ul>
                    <li><a href="#" class="active" onclick="showSection('dashboard')"><i class="fas fa-tachometer-alt"></i> لوحة التحكم</a></li>
                    <li><a href="#" onclick="showSection('orders')"><i class="fas fa-shopping-bag"></i> الطلبات</a></li>
                    <li><a href="#" onclick="showSection('products')"><i class="fas fa-box"></i> المنتجات</a></li>
                    <li><a href="#" onclick="showSection('users')"><i class="fas fa-users"></i> العملاء</a></li>
                    <li><a href="#" onclick="showSection('analytics')"><i class="fas fa-chart-line"></i> التحليلات</a></li>
                    <li><a href="#" onclick="showSection('settings')"><i class="fas fa-cog"></i> الإعدادات</a></li>
                </ul>
            </nav>
            
            <div style="padding: 20px; margin-top: 30px; border-top: 1px solid rgba(157, 78, 221, 0.3);">
                <a href="index.html" style="display: flex; align-items: center; gap: 10px; color: var(--text-gray); text-decoration: none;">
                    <i class="fas fa-arrow-left"></i>
                    العودة للمتجر
                </a>
            </div>
        </aside>
        
        <!-- المحتوى الرئيسي -->
        <main class="admin-content">
            <!-- الرأس -->
            <div class="admin-header">
                <div>
                    <h1 id="pageTitle">لوحة التحكم</h1>
                    <p id="pageSubtitle" style="color: var(--text-gray); margin-top: 5px;">مرحباً بعودتك، حمزة!</p>
                </div>
                <div>
                    <input type="text" class="search-box" placeholder="بحث..." id="adminSearch">
                </div>
            </div>
            
            <!-- لوحة التحكم -->
            <section id="dashboard" class="admin-section active">
                <div class="admin-stats">
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-shopping-cart"></i></div>
                        <div class="stat-value" id="totalOrders">0</div>
                        <div class="stat-label">إجمالي الطلبات</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-users"></i></div>
                        <div class="stat-value" id="totalUsers">0</div>
                        <div class="stat-label">عدد العملاء</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-money-bill-wave"></i></div>
                        <div class="stat-value" id="totalRevenue">0 دينار</div>
                        <div class="stat-label">إجمالي المبيعات</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-box-open"></i></div>
                        <div class="stat-value" id="totalProducts">0</div>
                        <div class="stat-label">المنتجات</div>
                    </div>
                </div>
                
                <div class="admin-table">
                    <div class="table-header">
                        <h3>آخر الطلبات</h3>
                        <button class="action-btn btn-view" onclick="showSection('orders')">عرض الكل</button>
                    </div>
                    <div id="recentOrders">
                        <!-- سيتم ملؤه بـ JavaScript -->
                    </div>
                </div>
            </section>
            
            <!-- قسم الطلبات -->
            <section id="orders" class="admin-section">
                <div class="admin-table">
                    <div class="table-header">
                        <h3>إدارة الطلبات</h3>
                        <div>
                            <select id="orderFilter" style="padding: 8px; border-radius: 5px; background: rgba(26, 26, 46, 0.7); color: var(--text-light); border: 1px solid rgba(157, 78, 221, 0.3);">
                                <option value="all">جميع الطلبات</option>
                                <option value="new">قيد الانتظار</option>
                                <option value="processing">قيد التجهيز</option>
                                <option value="delivered">تم التسليم</option>
                                <option value="cancelled">ملغاة</option>
                            </select>
                        </div>
                    </div>
                    <div id="ordersTable">
                        <!-- سيتم ملؤه بـ JavaScript -->
                    </div>
                </div>
            </section>
            
            <!-- قسم المنتجات -->
            <section id="products" class="admin-section">
                <div class="admin-table">
                    <div class="table-header">
                        <h3>إدارة المنتجات</h3>
                        <button class="action-btn btn-edit" onclick="addNewProduct()"><i class="fas fa-plus"></i> إضافة منتج</button>
                    </div>
                    <div id="productsTable">
                        <!-- سيتم ملؤه بـ JavaScript -->
                    </div>
                </div>
            </section>
            
            <!-- قسم العملاء -->
            <section id="users" class="admin-section">
                <div class="admin-table">
                    <div class="table-header">
                        <h3>إدارة العملاء</h3>
                    </div>
                    <div id="usersTable">
                        <!-- سيتم ملؤه بـ JavaScript -->
                    </div>
                </div>
            </section>
            
            <!-- قسم التحليلات -->
            <section id="analytics" class="admin-section">
                <div class="admin-table">
                    <div class="table-header">
                        <h3>تقارير وتحليلات</h3>
                    </div>
                    <div id="analyticsContent" style="padding: 20px;">
                        <div class="empty-state">
                            <i class="fas fa-chart-pie fa-3x"></i>
                            <h3>قريباً</h3>
                            <p>سيتم تفعيل قسم التحليلات قريباً</p>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- قسم الإعدادات -->
            <section id="settings" class="admin-section">
                <div class="admin-table">
                    <div class="table-header">
                        <h3>الإعدادات</h3>
                    </div>
                    <div id="settingsContent" style="padding: 20px;">
                        <div class="empty-state">
                            <i class="fas fa-cogs fa-3x"></i>
                            <h3>قريباً</h3>
                            <p>سيتم تفعيل قسم الإعدادات قريباً</p>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>
    
    <!-- نموذج تفاصيل الطلب -->
    <div class="modal" id="orderDetailsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>تفاصيل الطلب</h3>
                <button class="close-modal" onclick="closeModal()">&times;</button>
            </div>
            <div id="orderDetailsContent"></div>
        </div>
    </div>
    
    <script>
        // بيانات الإدارة
        let adminData = {
            orders: [],
            users: [],
            products: []
        };
        
        // تحميل البيانات
        function loadAdminData() {
            // تحميل الطلبات
            const savedOrders = localStorage.getItem('neonStoreOrders');
            adminData.orders = savedOrders ? JSON.parse(savedOrders) : [];
            
            // تحميل المستخدمين
            const savedUsers = localStorage.getItem('neonStoreUsers');
            adminData.users = savedUsers ? JSON.parse(savedUsers) : [];
            
            // تحميل المنتجات
            const savedProducts = localStorage.getItem('neonStoreProducts');
            adminData.products = savedProducts ? JSON.parse(savedProducts) : [];
            
            // إضافة المستخدم الافتراضي
            const defaultUser = {
                id: 1,
                name: 'حمزة',
                email: 'ahmadaiiroot@gmail.com',
                phone: '0790680891',
                address: 'عمان، الأردن',
                createdAt: '2023-01-01'
            };
            
            if (!adminData.users.some(u => u.email === 'ahmadaiiroot@gmail.com')) {
                adminData.users.unshift(defaultUser);
            }
            
            // تحديث الإحصائيات
            updateAdminStats();
        }
        
        // تحديث الإحصائيات
        function updateAdminStats() {
            document.getElementById('totalOrders').textContent = adminData.orders.length;
            document.getElementById('totalUsers').textContent = adminData.users.length;
            document.getElementById('totalProducts').textContent = adminData.products.length;
            
            // حساب إجمالي المبيعات
            const totalRevenue = adminData.orders.reduce((sum, order) => sum + order.amount, 0);
            document.getElementById('totalRevenue').textContent = totalRevenue + ' دينار';
        }
        
        // عرض الأقسام
        function showSection(sectionId) {
            // إخفاء جميع الأقسام
            document.querySelectorAll('.admin-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // إظهار القسم المطلوب
            document.getElementById(sectionId).classList.add('active');
            
            // تحديث الروابط النشطة
            document.querySelectorAll('.admin-nav a').forEach(link => {
                link.classList.remove('active');
                if (link.onclick && link.onclick.toString().includes(sectionId)) {
                    link.classList.add('active');
                }
            });
            
            // تحديث العناوين
            const titles = {
                'dashboard': 'لوحة التحكم',
                'orders': 'إدارة الطلبات',
                'products': 'إدارة المنتجات',
                'users': 'إدارة العملاء',
                'analytics': 'التحليلات',
                'settings': 'الإعدادات'
            };
            
            const subtitles = {
                'dashboard': 'نظرة عامة على المتجر',
                'orders': 'إدارة وتتبع الطلبات',
                'products': 'إدارة المنتجات والمخزون',
                'users': 'إدارة حسابات العملاء',
                'analytics': 'تقارير وإحصائيات',
                'settings': 'إعدادات المتجر'
            };
            
            document.getElementById('pageTitle').textContent = titles[sectionId] || 'لوحة التحكم';
            document.getElementById('pageSubtitle').textContent = subtitles[sectionId] || '';
            
            // تحميل بيانات القسم
            loadSectionData(sectionId);
        }
        
        // تحميل بيانات القسم
        function loadSectionData(sectionId) {
            switch(sectionId) {
                case 'dashboard':
                    loadDashboard();
                    break;
                case 'orders':
                    loadOrders();
                    break;
                case 'products':
                    loadProducts();
                    break;
                case 'users':
                    loadUsers();
                    break;
            }
        }
        
        // تحميل لوحة التحكم
        function loadDashboard() {
            // عرض آخر 5 طلبات
            const recentOrders = adminData.orders.slice(0, 5);
            const recentOrdersDiv = document.getElementById('recentOrders');
            
            if (recentOrders.length === 0) {
                recentOrdersDiv.innerHTML = '<div class="empty-state"><i class="fas fa-shopping-bag"></i><p>لا توجد طلبات بعد</p></div>';
                return;
            }
            
            let html = '<table><thead><tr><th>رقم الطلب</th><th>العميل</th><th>التاريخ</th><th>الحالة</th><th>الإجراءات</th></tr></thead><tbody>';
            
            recentOrders.forEach(order => {
                const statusClass = getStatusClass(order.status);
                const statusText = getStatusText(order.status);
                
                html += `
                    <tr>
                        <td>${order.id}</td>
                        <td>${order.customer}</td>
                        <td>${order.date}</td>
                        <td><span class="badge ${statusClass}">${statusText}</span></td>
                        <td>
                            <button class="action-btn btn-view" onclick="viewOrder('${order.id}')">عرض</button>
                            <button class="action-btn btn-edit" onclick="updateOrderStatus('${order.id}', 'processing')">تجهيز</button>
                        </td>
                    </tr>
                `;
            });
            
            html += '</tbody></table>';
            recentOrdersDiv.innerHTML = html;
        }
        
        // تحميل الطلبات
        function loadOrders() {
            const filter = document.getElementById('orderFilter').value;
            let filteredOrders = adminData.orders;
            
            if (filter !== 'all') {
                filteredOrders = adminData.orders.filter(order => order.status === filter);
            }
            
            const ordersTable = document.getElementById('ordersTable');
            
            if (filteredOrders.length === 0) {
                ordersTable.innerHTML = '<div class="empty-state"><i class="fas fa-shopping-bag"></i><p>لا توجد طلبات</p></div>';
                return;
            }
            
            let html = '<table><thead><tr><th>رقم الطلب</th><th>العميل</th><th>الهاتف</th><th>التاريخ</th><th>المبلغ</th><th>الحالة</th><th>الإجراءات</th></tr></thead><tbody>';
            
            filteredOrders.forEach(order => {
                const statusClass = getStatusClass(order.status);
                const statusText = getStatusText(order.status);
                
                html += `
                    <tr>
                        <td>${order.id}</td>
                        <td>${order.customer}</td>
                        <td>${order.phone}</td>
                        <td>${order.date}</td>
                        <td>${order.amount} دينار</td>
                        <td><span class="badge ${statusClass}">${statusText}</span></td>
                        <td>
                            <button class="action-btn btn-view" onclick="viewOrder('${order.id}')">عرض</button>
                            <button class="action-btn btn-edit" onclick="updateOrderStatus('${order.id}', 'processing')">تجهيز</button>
                            <button class="action-btn btn-delivered" onclick="updateOrderStatus('${order.id}', 'delivered')">تسليم</button>
                            <button class="action-btn btn-delete" onclick="deleteOrder('${order.id}')">حذف</button>
                        </td>
                    </tr>
                `;
            });
            
            html += '</tbody></table>';
            ordersTable.innerHTML = html;
        }
        
        // تحميل المنتجات
        function loadProducts() {
            const productsTable = document.getElementById('productsTable');
            
            if (adminData.products.length === 0) {
                productsTable.innerHTML = '<div class="empty-state"><i class="fas fa-box"></i><p>لا توجد منتجات</p></div>';
                return;
            }
            
            let html = '<table><thead><tr><th>الصورة</th><th>المنتج</th><th>السعر</th><th>المخزون</th><th>التصنيف</th><th>الإجراءات</th></tr></thead><tbody>';
            
            adminData.products.forEach(product => {
                html += `
                    <tr>
                        <td><img src="${product.image || 'https://via.placeholder.com/50x50/16213e/ffffff?text=P'}" style="width: 50px; height: 50px; object-fit: cover; border-radius: 5px;"></td>
                        <td>${product.name}</td>
                        <td>${product.price} دينار</td>
                        <td><span style="color: ${product.stock > 0 ? 'var(--galaxy-green)' : 'var(--danger)'}">${product.stock}</span></td>
                        <td>${product.category || 'إلكترونيات'}</td>
                        <td>
                            <button class="action-btn btn-edit" onclick="editProduct(${product.id})">تعديل</button>
                            <button class="action-btn btn-delete" onclick="deleteProduct(${product.id})">حذف</button>
                        </td>
                    </tr>
                `;
            });
            
            html += '</tbody></table>';
            productsTable.innerHTML = html;
        }
        
        // تحميل العملاء
        function loadUsers() {
            const usersTable = document.getElementById('usersTable');
            
            if (adminData.users.length === 0) {
                usersTable.innerHTML = '<div class="empty-state"><i class="fas fa-users"></i><p>لا توجد عملاء</p></div>';
                return;
            }
            
            let html = '<table><thead><tr><th>الاسم</th><th>البريد الإلكتروني</th><th>الهاتف</th><th>تاريخ التسجيل</th><th>العنوان</th><th>الإجراءات</th></tr></thead><tbody>';
            
            adminData.users.forEach(user => {
                html += `
                    <tr>
                        <td>${user.name}</td>
                        <td>${user.email}</td>
                        <td>${user.phone || 'غير محدد'}</td>
                        <td>${user.createdAt ? user.createdAt.substring(0, 10) : 'غير محدد'}</td>
                        <td>${user.address || 'غير محدد'}</td>
                        <td>
                            <button class="action-btn btn-view" onclick="viewUser(${user.id})">عرض</button>
                            <button class="action-btn btn-delete" onclick="deleteUser(${user.id})">حذف</button>
                        </td>
                    </tr>
                `;
            });
            
            html += '</tbody></table>';
            usersTable.innerHTML = html;
        }
        
        // دوال المساعدة
        function getStatusClass(status) {
            const classes = {
                'new': 'badge-new',
                'processing': 'badge-processing',
                'delivered': 'badge-delivered',
                'cancelled': 'badge-cancelled'
            };
            return classes[status] || 'badge-new';
        }
        
        function getStatusText(status) {
            const texts = {
                'new': 'قيد الانتظار',
                'processing': 'قيد التجهيز',
                'delivered': 'تم التسليم',
                'cancelled': 'ملغاة'
            };
            return texts[status] || 'قيد الانتظار';
        }
        
        // عرض تفاصيل الطلب
        function viewOrder(orderId) {
            const order = adminData.orders.find(o => o.id === orderId);
            if (!order) return;
            
            const modal = document.getElementById('orderDetailsModal');
            const content = document.getElementById('orderDetailsContent');
            
            const productsHTML = order.products.map(product => `
                <div style="display: flex; align-items: center; gap: 15px; padding: 10px; background: rgba(26, 26, 46, 0.5); border-radius: 5px; margin-bottom: 10px;">
                    <div>${product.name}</div>
                    <div style="margin-right: auto;">${product.quantity} × ${product.price} دينار</div>
                    <div><strong>${product.quantity * product.price} دينار</strong></div>
                </div>
            `).join('');
            
            content.innerHTML = `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: var(--galaxy-cyan); margin-bottom: 10px;">معلومات العميل</h4>
                    <p><strong>الاسم:</strong> ${order.customer}</p>
                    <p><strong>الهاتف:</strong> ${order.phone}</p>
                    <p><strong>البريد:</strong> ${order.email || 'غير محدد'}</p>
                    <p><strong>العنوان:</strong> ${order.address}</p>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: var(--galaxy-cyan); margin-bottom: 10px;">معلومات الطلب</h4>
                    <p><strong>رقم الطلب:</strong> ${order.id}</p>
                    <p><strong>التاريخ:</strong> ${order.date} - ${order.time}</p>
                    <p><strong>طريقة الدفع:</strong> ${order.paymentMethod === 'cash' ? 'الدفع عند الاستلام' : 'التواصل'}</p>
                    <p><strong>الحالة:</strong> <span class="badge ${getStatusClass(order.status)}">${getStatusText(order.status)}</span></p>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: var(--galaxy-cyan); margin-bottom: 10px;">المنتجات</h4>
                    ${productsHTML}
                </div>
                
                <div style="background: rgba(26, 26, 46, 0.5); padding: 15px; border-radius: 5px; text-align: left;">
                    <h4 style="color: var(--galaxy-green);">الإجمالي: ${order.amount} دينار</h4>
                </div>
                
                <div style="margin-top: 20px; display: flex; gap: 10px;">
                    <button class="action-btn btn-edit" style="flex: 1;" onclick="updateOrderStatus('${order.id}', 'processing')">تغيير للتجهيز</button>
                    <button class="action-btn btn-delivered" style="flex: 1;" onclick="updateOrderStatus('${order.id}', 'delivered')">تم التسليم</button>
                </div>
            `;
            
            modal.classList.add('active');
        }
        
        // تحديث حالة الطلب
        function updateOrderStatus(orderId, newStatus) {
            const orderIndex = adminData.orders.findIndex(o => o.id === orderId);
            if (orderIndex === -1) return;
            
            adminData.orders[orderIndex].status = newStatus;
            
            // حفظ في localStorage
            localStorage.setItem('neonStoreOrders', JSON.stringify(adminData.orders));
            
            // إعادة تحميل البيانات
            loadAdminData();
            
            // إعادة تحميل العرض الحالي
            const currentSection = document.querySelector('.admin-section.active').id;
            loadSectionData(currentSection);
            
            // إغلاق النافذة المنبثقة إذا كانت مفتوحة
            closeModal();
            
            alert(`تم تحديث حالة الطلب ${orderId} إلى ${getStatusText(newStatus)}`);
        }
        
        // حذف الطلب
        function deleteOrder(orderId) {
            if (!confirm('هل أنت متأكد من حذف هذا الطلب؟')) return;
            
            adminData.orders = adminData.orders.filter(o => o.id !== orderId);
            localStorage.setItem('neonStoreOrders', JSON.stringify(adminData.orders));
            
            loadAdminData();
            const currentSection = document.querySelector('.admin-section.active').id;
            loadSectionData(currentSection);
            
            alert('تم حذف الطلب بنجاح');
        }
        
        // حذف المنتج
        function deleteProduct(productId) {
            if (!confirm('هل أنت متأكد من حذف هذا المنتج؟')) return;
            
            adminData.products = adminData.products.filter(p => p.id !== productId);
            localStorage.setItem('neonStoreProducts', JSON.stringify(adminData.products));
            
            loadAdminData();
            loadProducts();
            
            alert('تم حذف المنتج بنجاح');
        }
        
        // حذف العميل
        function deleteUser(userId) {
            if (!confirm('هل أنت متأكد من حذف هذا العميل؟ سيتم حذف جميع طلباته أيضاً.')) return;
            
            const user = adminData.users.find(u => u.id === userId);
            if (!user) return;
            
            // حذف المستخدم
            adminData.users = adminData.users.filter(u => u.id !== userId);
            
            // حذف طلبات المستخدم
            adminData.orders = adminData.orders.filter(o => 
                o.email !== user.email && o.phone !== user.phone
            );
            
            // حفظ التغييرات
            localStorage.setItem('neonStoreUsers', JSON.stringify(adminData.users));
            localStorage.setItem('neonStoreOrders', JSON.stringify(adminData.orders));
            
            loadAdminData();
            loadUsers();
            
            alert('تم حذف العميل وطلباته بنجاح');
        }
        
        // إغلاق النافذة المنبثقة
        function closeModal() {
            document.getElementById('orderDetailsModal').classList.remove('active');
        }
        
        // إضافة منتج جديد
        function addNewProduct() {
            const name = prompt('اسم المنتج:');
            if (!name) return;
            
            const price = parseFloat(prompt('سعر المنتج (دينار):'));
            if (isNaN(price)) return;
            
            const stock = parseInt(prompt('كمية المخزون:'));
            if (isNaN(stock)) return;
            
            const description = prompt('وصف المنتج:') || '';
            
            const newProduct = {
                id: adminData.products.length > 0 ? Math.max(...adminData.products.map(p => p.id)) + 1 : 1,
                name: name,
                price: price,
                stock: stock,
                description: description,
                category: 'إلكترونيات',
                icon: 'fas fa-box',
                image: 'https://images.unsplash.com/photo-1484704849700-f032a568e944?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80'
            };
            
            adminData.products.push(newProduct);
            localStorage.setItem('neonStoreProducts', JSON.stringify(adminData.products));
            
            loadAdminData();
            loadProducts();
            
            alert('تم إضافة المنتج بنجاح');
        }
        
        // تعديل المنتج
        function editProduct(productId) {
            const product = adminData.products.find(p => p.id === productId);
            if (!product) return;
            
            const newPrice = parseFloat(prompt('السعر الجديد:', product.price));
            if (isNaN(newPrice)) return;
            
            const newStock = parseInt(prompt('المخزون الجديد:', product.stock));
            if (isNaN(newStock)) return;
            
            product.price = newPrice;
            product.stock = newStock;
            
            localStorage.setItem('neonStoreProducts', JSON.stringify(adminData.products));
            
            loadAdminData();
            loadProducts();
            
            alert('تم تحديث المنتج بنجاح');
        }
        
        // البحث
        document.getElementById('adminSearch').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const currentSection = document.querySelector('.admin-section.active').id;
            
            // تطبيق البحث حسب القسم الحالي
            switch(currentSection) {
                case 'orders':
                    searchOrders(searchTerm);
                    break;
                case 'products':
                    searchProducts(searchTerm);
                    break;
                case 'users':
                    searchUsers(searchTerm);
                    break;
            }
        });
        
        function searchOrders(term) {
            if (!term) {
                loadOrders();
                return;
            }
            
            const filteredOrders = adminData.orders.filter(order => 
                order.id.toLowerCase().includes(term) ||
                order.customer.toLowerCase().includes(term) ||
                order.phone.includes(term)
            );
            
            // تحديث العرض
            const ordersTable = document.getElementById('ordersTable');
            
            if (filteredOrders.length === 0) {
                ordersTable.innerHTML = '<div class="empty-state"><i class="fas fa-search"></i><p>لا توجد نتائج للبحث</p></div>';
                return;
            }
            
            // ... بناء الجدول بنفس الطريقة مع البيانات المصفاة
        }
        
        // تهيئة الصفحة
        document.addEventListener('DOMContentLoaded', function() {
            loadAdminData();
            showSection('dashboard');
            
            // إضافة أحداث للفلتر
            document.getElementById('orderFilter').addEventListener('change', function() {
                loadOrders();
            });
            
            // إغلاق النافذة المنبثقة عند النقر خارجها
            document.getElementById('orderDetailsModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeModal();
                }
            });
        });
    </script>
</body>
</html>